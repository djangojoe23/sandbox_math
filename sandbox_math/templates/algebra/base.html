{% extends "base.html" %}
{% load static i18n compress %}
{% load algebra_extras %}

{% block css %}
  {{ block.super }}
  <link href="{% static 'css/mathquill-basic.css' %}" rel="stylesheet">
{% endblock css %}

{% block javascript %}
  {{ block.super }}
    <script defer src="{% static 'js/mathquill-0.10.1/mathquill-basic.js' %}"></script>
      <script defer src="{% static 'js/calculator.js' %}"></script>
    <script defer src="{% static 'js/algebra.js' %}"></script>
    <script defer src="{% static 'js/algebra-recent-table.js' %}"></script>

{% endblock javascript %}

{% block content %}
  <div id="myModal" class="modal" data-bs-backdrop="static" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <ul class="nav nav-tabs flex-nowrap text-nowrap mb-n2" role="tablist">
          <li class="nav-item">
            <a href="#signin" class="nav-link flex-column flex-sm-row px-3 px-sm-4 active" data-bs-toggle="tab" role="tab" aria-selected="true">
              <i class="ai-login me-sm-2 ms-sm-n1"></i>
              <span class="d-none d-sm-inline">Sign in</span>
              <span class="fs-sm fw-medium d-sm-none pt-1">Sign in</span>
            </a>
          </li>
          <li class="nav-item">
            <a href="#signup" class="nav-link flex-column flex-sm-row px-3 px-sm-4" data-bs-toggle="tab" role="tab" aria-selected="false">
              <i class="ai-user me-sm-2 ms-sm-n1"></i>
              <span class="d-none d-sm-inline">Sign up</span>
              <span class="fs-sm fw-medium d-sm-none pt-1">Sign up</span>
            </a>
          </li>
        </ul>
        <button class="btn-close" type="button" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body tab-content">
        <form class="tab-pane fade show active mt-n2" id="signin" autocomplete="off">
          <div class="mb-3 mb-sm-4">
            <label for="email1" class="form-label">Email address</label>
            <input type="email" class="form-control" id="email1" placeholder="johndoe@example.com">
          </div>
          <div class="mb-3 mb-sm-4">
            <label for="pass1" class="form-label">Password</label>
            <div class="password-toggle">
              <input type="password" class="form-control" id="pass1">
              <label class="password-toggle-btn">
                <input class="password-toggle-check" type="checkbox">
                <span class="password-toggle-indicator"></span>
              </label>
            </div>
          </div>
          <div class="mb-4 d-flex flex-wrap justify-content-between">
            <div class="form-check mb-2">
              <input type="checkbox" class="form-check-input" id="remember">
              <label for="remember" class="form-check-label">Remember me</label>
            </div>
            <a href="#" class="fs-sm">Forgot password?</a>
          </div>
          <button type="submit" class="btn btn-primary w-100">Sign in</button>
        </form>
        <form class="tab-pane fade" id="signup" autocomplete="off">
          <div class="mb-3 mb-sm-4">
            <label for="name" class="form-label">Full name</label>
            <input type="text" class="form-control" id="name" placeholder="John Doe">
          </div>
          <div class="mb-3 mb-sm-4">
            <label for="email2" class="form-label">Email address</label>
            <input type="email" class="form-control" id="email2" placeholder="johndoe@example.com">
          </div>
          <div class="mb-3 mb-sm-4">
            <label for="pass2" class="form-label">Password</label>
            <div class="password-toggle">
              <input type="password" class="form-control" id="pass2">
              <label class="password-toggle-btn">
                <input type="checkbox" class="password-toggle-check">
                <span class="password-toggle-indicator"></span>
              </label>
            </div>
          </div>
          <div class="mb-4">
            <label for="pass3" class="form-label">Confirm password</label>
            <div class="password-toggle">
              <input type="password" class="form-control" id="pass3">
              <label class="password-toggle-btn">
                <input type="checkbox" class="password-toggle-check">
                <span class="password-toggle-indicator"></span>
              </label>
            </div>
          </div>
          <button type="submit" class="btn btn-primary w-100">Sign up</button>
        </form>
      </div>
    </div>
  </div>
</div>


<div class="container py-5 mt-4 mt-lg-5 mb-lg-4 my-xl-5">
  <div class="row pt-sm-2 pt-lg-0">
    <div class="col pt-4 pb-4 pb-sm-4 pe-0">
      <div class="row position-relative overflow-hidden gx-2 zindex-1">
        <div class="col" >
          <div class="offcanvas offcanvas-start position-absolute bg-light rounded-5 border" id="offcanvasMenu" data-bs-scroll="true" data-bs-backdrop="false">
            <div class="rounded-5 overflow-hidden">
              <div class="card-header w-100 border-0 px-4 pt-4 pb-3">
                <div class="d-flex justify-content-end mt-n2 mb-2">
                  <button class="btn btn-outline-secondary border-0 px-3 me-n2" type="button" data-bs-dismiss="offcanvas" data-bs-target=" #offcanvasMenu"><i class="ai-cross me-2"></i>Close</button>
                </div>
              </div>
              <div class="card-body px-0 pb-4 pb-xl-0 pt-1">
                <!-- Offcanvas Menu-->
                <ul class="nav nav-tabs flex-column" role="tablist">
                  <li class="nav-item">
                    <a class="nav-link active" href="#current" data-bs-toggle="tab" role="tab">Current</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#recent" data-bs-toggle="tab" role="tab">Recent</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#example" data-bs-toggle="tab" role="tab">Example</a>
                  </li>
{#                  <li class="nav-item">#}
{#                    <a class="nav-link" href="#suggestions" data-bs-toggle="tab" role="tab">Suggestions</a>#}
{#                  </li>#}
                  <li class="nav-item">
                    <a class="nav-link" href="{% url 'algebra:base' %}" data-bs-toggle="" role="link">New Blank</a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class="card border-0">
            <!-- Header-->
            <div class="navbar card-header w-100 mx-0 px-4">
              <div class="d-flex align-items-center w-100 px-sm-3">
                <button class="navbar-toggler me-3 me-sm-4" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasMenu" aria-controls="contactsList" aria-label="Toggle contacts list"><span class="navbar-toggler-icon"></span></button>
                <div class="h6 ps-2 ms-1 mb-0 w-100">{% if problem_finished == 'problem-finished' %}<span class="particletext letterconfetti">This Problem is Solved!</span>{% else %}Current{% endif %}</div>
              </div>
            </div>
            <!-- Body-->
            <div class="card-body pb-4 pt-1 px-2">
              <div class="tab-content">
                <div class="tab-pane fade show active" id="current" role="tabpanel">
                  {% csrf_token %}
                  <div class="d-flex flex-row align-items-stretch">
                    <div class="d-flex flex-column flex-grow-1">
                      <div class="ms-auto">
                        <a href="#" data-bs-target="#sidebar" data-bs-toggle="collapse" class="fs-4"><i class="ai-arrow-left"></i><i class="ai-messages"></i><i class="ai-arrow-right"></i></a>
                      </div>
                      <div class="d-none {{ problem_finished }}" id="unique-problem-id" >{{ problem.id }}</div>
                      <div id="algebra" class="steps mt-1" style="margin: 10px;">
                        {% for step in steps %}
                          <div id="step{{ step.id }}" class="step algebra-step pb-1 {{ step.step_type }} {% if forloop.counter > 2 %}pt-3{% else %}pt-0{% endif %}" style="">
                            {% include "algebra/new_step.html" with is_new_problem=is_new_problem problem=problem step_num=forloop.counter step=step step_prompts=step_prompts total_steps=steps|length %}
                          </div>
                        {% endfor %}
                        <div id="newStepButtonStep" class="step py-0" style="">
                          <div class="step-number" style="visibility: hidden">
                            <div class="step-number-inner"></div>
                          </div>
                          <div class="step-body ps-2 container-fluid">
                            <div class="d-flex flex-column align-items-center pb-2">
                              <div class="mt-1">
                                  <button id="checkSolutionButton" type="button" class="btn btn-lg btn-outline-primary d-none"><i class="ai-check me-2"></i>Check Solution</button>
                              </div>
                              <div class="mt-1">
                                  <button id="newStepButton" type="button" class="btn btn-lg btn-outline-primary"><i class="ai-list me-2"></i>New Step</button>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="border-start ms-auto">
                      <div id="sidebar" class="collapse collapse-horizontal show h-100">
                          <div id="sidebar-nav" class="rounded-0 text-sm-start h-100">
                            {% include "calculator/base.html" with previous_messages=previous_user_messages active_check_process=active_check_process %}
                          </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="tab-pane fade" id="recent" role="tabpanel">
                  {% include "algebra/recent_table/base.html" %}
                </div>
                <div class="tab-pane fade" id="example" role="tabpanel">
                  {% include "algebra/example.html" %}
                </div>
                <div class="tab-pane fade" id="suggestions" role="tabpanel">
                  <h4>Suggestions</h4>
                </div>
              </div>
            </div>
            <!-- Footer (Textarea)-->
            <div class="card-footer w-100 border-0 mx-0 px-4 py-1">

            </div>

            <div id="expressionHelp" style="display: none;">
              {% for step in steps %}
                <div id="step{{ step.id }}Help">
                {% for mistake in step|get_step_mistakes %}
                  <div class="{{ mistake.side }}-help-button-title">
                    {{ mistake.title}}
                  </div>
                  <div class="{{ mistake.side }}-help-button-content">
                    {{ mistake.content }}
                  </div>
                {% endfor %}
                </div>
              {% endfor %}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock content %}

{% block footer %}

{% endblock footer %}

{% block inline_javascript %}
  {{ block.super }}

{% endblock inline_javascript %}
